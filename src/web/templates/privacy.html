{% extends "base.html" %}

{% block title %}Politique de Confidentialité - Cats vs Dogs Classifier{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-8 mx-auto">
        <div class="card shadow">
            <div class="card-header bg-secondary text-white">
                <h4 class="mb-0"><i class="bi bi-shield-check"></i> Politique de Confidentialité (RGPD)</h4>
            </div>
            <div class="card-body">
                <h5>Introduction</h5>
                <p>
                    Dans le cadre de l'amélioration continue de notre service de classification d'images "Cats vs Dogs", nous collectons des données de feedback. Cette page a pour but de vous informer sur la manière dont vos données sont collectées, utilisées et protégées, conformément au Règlement Général sur la Protection des Données (RGPD).
                </p>

                <hr>

                <h5>Données collectées</h5>
                <p>
                    Lorsque vous soumettez un feedback ("Correct" ou "Incorrect") sur une prédiction, nous vous demandons votre consentement pour stocker les données suivantes :
                </p>
                <ul>
                    <li>L'<strong>image</strong> que vous avez soumise pour la prédiction.</li>
                    <li>Le <strong>résultat de la prédiction</strong> généré par notre modèle (ex: "Cat").</li>
                    <li>Votre <strong>feedback</strong> (correct ou incorrect).</li>
                    <li>Un <strong>horodatage</strong> de la soumission.</li>
                </ul>
                <p>Aucune autre information personnelle (adresse IP, identifiants, etc.) n'est stockée avec votre feedback.</p>

                <hr>

                <h5>Finalité de la collecte</h5>
                <p>
                    Les images et les feedbacks associés sont utilisés <strong>uniquement</strong> dans le but d'améliorer la précision et la performance de notre modèle d'intelligence artificielle. Ils nous permettent d'identifier les cas où le modèle se trompe et de le ré-entraîner pour qu'il devienne plus fiable.
                </p>

                <hr>

                <h5>Gestion de votre consentement</h5>
                <p>
                    Vous pouvez à tout moment consulter et modifier votre choix concernant le stockage de vos images pour l'amélioration du service. Votre décision est enregistrée localement dans votre navigateur et ne sera pas redemandée tant que vous ne la modifiez pas.
                </p>
                <div id="consent-status-container" class="mt-3">
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const consentContainer = document.getElementById('consent-status-container');
    const consentKey = 'image-consent-given';

    function updateConsentStatus() {
        const consentGiven = localStorage.getItem(consentKey) === 'true';

        if (consentGiven) {
            consentContainer.innerHTML = `
                <div class="alert alert-success d-flex align-items-center">
                    <i class="bi bi-check-circle-fill me-2"></i>
                    <div>Vous avez actuellement <strong>accepté</strong> de partager vos images.</div>
                </div>
                <button id="revokeConsentBtn" class="btn btn-danger">Révoquer le consentement</button>
            `;
            document.getElementById('revokeConsentBtn').addEventListener('click', () => {
                localStorage.removeItem(consentKey);
                updateConsentStatus();
            });
        } else {
            consentContainer.innerHTML = `
                <div class="alert alert-warning d-flex align-items-center">
                    <i class="bi bi-exclamation-triangle-fill me-2"></i>
                    <div>Vous n'avez <strong>pas donné</strong> votre consentement (ou vous l'avez révoqué).</div>
                </div>
            `;
        }
    }

    updateConsentStatus();
});
</script>
{% endblock %}
